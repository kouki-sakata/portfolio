<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{common/head_fragment :: head_content(pageTitle='TIME MANAGER / 従業員情報管理')}"></head>
<body>
<!-- 共通ヘッダー -->
<header th:replace="~{common/header}"></header>
<!-- メインコンテンツ -->
<main class="main_content">
    <!-- ナビ選択用の設定値 -->
    <input id="target_nav" type="hidden" value="employee-manage"/>
    <!-- 共通ナビ -->
    <nav th:replace="~{common/navigation}"></nav>
    <!-- コンテンツ -->
    <section>
        <p class="mb-4 weight_600">
            従業員情報　新規登録・変更
        </p>
        <p class="mb-4">
            従業員情報を新規登録したい場合は、以下を入力して登録ボタンを押してください
        </p>
        <form id="regist_form" method="post" th:action="@{regist}"
              th:object="${employeeManageForm}">
            <input th:name="${_csrf.parameterName}" th:value="${_csrf.token}"
                   type="hidden"/>
            <div class="row">
                <div class="form-group col-md-2">
                    <label for="input_id">ID</label>
                    <input class="form-control" disabled id="input_id"
                           name="employeeId" type="text">
                </div>
                <div class="form-group col-md-2">
                    <label for="input_first_name">姓</label>
                    <input class="form-control" id="input_first_name"
                           maxlength="30" name="firstName"
                           th:classappend="${#fields.hasErrors('firstName')} ? 'is-invalid' : ''"
                           th:field="*{firstName}"
                           type="text">
                    <div class="text-danger small" id="first_name_error"
                         th:errors="*{firstName}"></div>
                </div>
                <div class="form-group col-md-2">
                    <label for="input_last_name">名</label>
                    <input class="form-control" id="input_last_name"
                           maxlength="30"
                           name="lastName"
                           th:classappend="${#fields.hasErrors('lastName')} ? 'is-invalid' : ''"
                           th:field="*{lastName}"
                           type="text">
                    <div class="text-danger small" id="last_name_error"
                         th:errors="*{lastName}"></div>
                </div>
                <div class="form-group col-md-2">
                    <label for="input_email">メールアドレス</label>
                    <input class="form-control form-control-small-font"
                           id="input_email"
                           maxlength="255"
                           name="email"
                           th:classappend="${#fields.hasErrors('email')} ? 'is-invalid' : ''"
                           th:field="*{email}"
                           type="email">
                    <div class="text-danger small" id="email_error"
                         th:errors="*{email}"></div>
                </div>
                <div class="form-group col-md-2">
                    <label for="input_password">パスワード</label>
                    <input class="form-control" id="input_password"
                           maxlength="16"
                           name="password"
                           th:classappend="${#fields.hasErrors('password')} ? 'is-invalid' : ''"
                           th:field="*{password}"
                           type="text">
                    <small class="form-text text-muted">8～16文字</small>
                    <div class="text-danger small" id="password_error"
                         th:errors="*{password}"></div>
                </div>
                <div class="form-group col-md-1 d-flex align-items-center">
                    <input id="admin_flag" name="adminFlag"
                           th:field="*{adminFlag}"
                           type="hidden">
                    <div class="form-check mt-4">
                        <input class="form-check-input" id="input_admin"
                               th:classappend="${#fields.hasErrors('adminFlag')} ? 'is-invalid' : ''"
                               th:field="*{adminFlag}"
                               th:value="1"
                               type="checkbox">
                        <label class="form-check-label"
                               for="input_admin">管理者</label>
                        <div class="text-danger small" id="admin_flag_error"
                             th:errors="*{adminFlag}"></div>
                    </div>
                </div>
            </div>
            <div class="d-flex justify-content-end gap-2 mt-3">
                <button class="btn bg_blue_info shadow height_3 btn-width-150"
                        id="regist" type="button">
                    <span aria-hidden="true"
                          class="spinner-border spinner-border-sm d-none"
                          role="status"></span>
                    <span class="button-text">登録</span>
                </button>
            </div>
        </form>
        <!-- エラーメッセージ表示エリア -->
        <div class="alert alert-danger mt-3" role="alert"
             th:if="${globalError}">
            <i class="fa-solid fa-triangle-exclamation me-2"></i>
            <span th:text="${globalError}"></span>
        </div>
        <p class="mt-4 text-danger" id="regist_message_area"
           th:text="${registResult}"></p>
        <p class="mb-4 weight_600">
            従業員一覧
        </p>
        <p class="mb-4">
            従業員情報を編集したい場合は、対象行の編集ボタンをクリックして「従業員情報　新規登録・変更」にて編集して登録ボタンを押してください
        </p>
        <p class="mb-4">
            従業員情報を削除したい場合は、対象行のチェックボックスをONにして削除ボタンを押してください（複数選択可）
        </p>
        <input id="employee_id" name="employeeId" type="hidden"/>
        <form id="delete_form" method="post" th:action="@{delete}">
            <input th:name="${_csrf.parameterName}" th:value="${_csrf.token}"
                   type="hidden"/>
            <div class="bg_white stamp_box margin_tp_2 table-responsive">
                <table class="table table-striped margin_tp_1"
                       id="employee-table" style="width: 100%">
                    <thead>
                    <tr>
                        <th><input class="form-check-input checkbox-large"
                                   id="select-all-employees"
                                   type="checkbox"></th>
                        <th>ID</th>
                        <th>姓</th>
                        <th>名</th>
                        <th>メールアドレス</th>
                        <th>パスワード</th>
                        <th>管理者</th>
                        <th>編集</th>
                    </tr>
                    </thead>
                    <tbody>
                    <!-- DataTables will populate this section dynamically -->
                    </tbody>
                </table>
            </div>
        </form>
        <button class="btn bg_red_info shadow height_3 mt-3 btn-width-150"
                id="delete"
                type="button">
            <span aria-hidden="true"
                  class="spinner-border spinner-border-sm d-none"
                  role="status"></span>
            <span class="button-text">削除</span>
        </button>
        <p class="mt-4 text-danger" id="delete_message_area"
           th:text="${deleteResult}"></p>
    </section>
</main>
<!-- 共通フッター -->
<footer th:replace="~{common/footer}"></footer>
<div th:replace="~{common/body_end_fragment :: body_end_content}"></div>
<!-- CSRF token for AJAX requests -->
<meta name="_csrf" th:content="${_csrf.token}"/>
<meta name="_csrf_header" th:content="${_csrf.headerName}"/>
<script type="text/javascript">
    window.csrfToken = /*[[${_csrf.token}]]*/ '';
    window.csrfHeaderName = /*[[${_csrf.headerName}]]*/ '';
</script>
<!-- employee_manage.js -->
<script th:src="@{/js/employee_manage.js}"></script>
</body>
</html>
