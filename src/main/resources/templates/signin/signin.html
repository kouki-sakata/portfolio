<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{common/head_fragment :: head_content(pageTitle='Sign In')}"></head>

<body class="modern-signin-body">
<main>
    <section class="signin-container">
        <div class="signin-card">
            <div class="signin-header">
                <div class="logo-container">
                    <div class="modern-logo">
                        <svg class="logo-svg" height="80" viewBox="0 0 100 100"
                             width="80"
                             xmlns="http://www.w3.org/2000/svg">
                            <!-- Background circle with gradient -->
                            <defs>
                                <linearGradient id="logoGradient" x1="0%"
                                                x2="100%" y1="0%" y2="100%">
                                    <stop offset="0%"
                                          style="stop-color:#667eea"/>
                                    <stop offset="100%"
                                          style="stop-color:#764ba2"/>
                                </linearGradient>
                                <filter id="glow">
                                    <feGaussianBlur result="coloredBlur"
                                                    stdDeviation="3"/>
                                    <feMerge>
                                        <feMergeNode in="coloredBlur"/>
                                        <feMergeNode in="SourceGraphic"/>
                                    </feMerge>
                                </filter>
                            </defs>

                            <!-- Main circle -->
                            <circle cx="50" cy="50" fill="url(#logoGradient)"
                                    filter="url(#glow)"
                                    r="45"/>

                            <!-- Clock elements for TIME MANAGER -->
                            <circle cx="50" cy="50" fill="none" opacity="0.3"
                                    r="35" stroke="white"
                                    stroke-width="2"/>

                            <!-- Clock hands -->
                            <line stroke="white" stroke-linecap="round" stroke-width="3" x1="50" x2="50"
                                  y1="50" y2="25"/>
                            <line stroke="white" stroke-linecap="round" stroke-width="2" x1="50" x2="65"
                                  y1="50" y2="50"/>

                            <!-- Center dot -->
                            <circle cx="50" cy="50" fill="white" r="3"/>

                            <!-- Hour markers -->
                            <circle cx="50" cy="20" fill="white" opacity="0.8"
                                    r="2"/>
                            <circle cx="80" cy="50" fill="white" opacity="0.8"
                                    r="2"/>
                            <circle cx="50" cy="80" fill="white" opacity="0.8"
                                    r="2"/>
                            <circle cx="20" cy="50" fill="white" opacity="0.8"
                                    r="2"/>
                        </svg>
                    </div>
                </div>
                <h1 class="signin-title" th:text="${msg ?: 'サインイン'}">
                    TIME MANAGER
                </h1>
                <p class="signin-subtitle">
                    メールアドレスとパスワードを入力してサインインしてください
                </p>
            </div>
            <form class="signin-form" id="signin_form" method="post" novalidate
                  th:action="@{/signin/login}">
                <input th:name="${_csrf.parameterName}"
                       th:value="${_csrf.token}"
                       type="hidden"/>

                <div class="form-group">
                    <label class="form-label" for="email">メールアドレス</label>
                    <input aria-describedby="emailHelp"
                           class="form-input"
                           id="email"
                           name="email"
                           placeholder="name@example.com"
                           required
                           th:value="${param.email}"
                           type="email">
                    <div class="form-text" id="emailHelp">
                        入力されたメールアドレスは、ご提供いただいた目的以外で使用することはありません
                    </div>
                    <div class="form-error">
                        有効なメールアドレスを入力してください
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label" for="password">パスワード</label>
                    <div class="password-input-wrapper">
                        <input class="form-input"
                               id="password"
                               name="password"
                               placeholder="パスワードを入力してください"
                               required
                               type="password">
                        <button aria-label="パスワードを表示/非表示"
                                class="password-toggle"
                                id="togglePassword"
                                type="button">
                            <i class="bi bi-eye-fill" id="toggleIcon"></i>
                        </button>
                    </div>
                </div>

                <button class="signin-button"
                        id="sign_in"
                        type='submit'>
                    <span class="signin-button-text">サインイン</span>
                </button>
            </form>
            <div class="message-container">
                <!-- ログアウト成功メッセージ -->
                <div class="alert alert-success" th:if="${param.logout}">
                    <i class="bi bi-check-circle-fill me-2"></i>
                    ログアウトしました
                </div>
                <!-- エラーメッセージ表示（タイムアウト時）-->
                <div class="alert alert-error" th:if="${param.error}">
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    ログインに失敗しました。メールアドレスとパスワードを確認してください
                </div>
                <p class="error-text" id="message_area" th:text="${result}"></p>
            </div>
        </div>
    </section>
</main>
<!-- 共通フッター -->
<div th:replace="~{common/body_end_fragment :: body_end_content}"></div>
<!-- signin.js -->
<script th:src="@{/js/sign_in.js}"></script>
</body>

</html>
