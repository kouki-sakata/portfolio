# Implementation Plan

- [x] 1. 公開属性を扱う保存基盤の刷新
  - 保存要求と応答に公開状態・タイトル・ラベルを統一的に含められるようデータ構造を整理する。
  - 永続層の更新によって既存フローとの互換性を保ち、公開状態の一貫性を担保する。
  - 追加項目を前提にした運用前確認を簡潔に整え、実装負荷を抑える。
  - _Requirements: R1, R2, R4_

- [x] 1.1 スキーマ更新と保存処理の拡張
  - 既存のスキーマ定義段階（02_schema）を直接書き換えてタイトルとラベルの列を追加し、バックアップ工程を省略する。
  - 新規作成と更新の保存処理で公開状態・タイトル・ラベルを一括で扱い、変化後の値を応答に含める。
  - 公開中リストやホーム向け供給の取得処理が新しい属性と整合するよう調整する。
  - _Requirements: R1, R2, R4_

- [x] 1.2 サーバー入力検証と既定値の適用
  - タイトル必須・100文字上限・ラベル候補固定の検証を追加し、不正な保存を即座に止める。
  - ラベル未指定時に既定値「一般」を適用し、公開トグル操作後の状態を応答へ反映する。
  - 検証メッセージを管理者が理解しやすい表現に整えて保存体験を滑らかにする。
  - _Requirements: R1, R2, R3_

- [x] 2. 管理フォームの入力体験向上
  - 公開トグル・タイトル・ラベル入力を自然な導線で配置し、編集時は既存値を初期表示する。
  - 操作直後のステータス表示を刷新し、公開状態の変化を即座に把握できるようにする。
  - 保存時のフィードバックとエラー表示を統一し、入力ミスを早期に気付けるようにする。
  - _Requirements: R1, R2, R3_

- [x] 2.1 公開トグルとタイトル入力の追加
  - 公開状態を切り替えるUIを配置し、フォーム内ステータスとリアルタイムで同期させる。
  - タイトル入力欄を導入し、空欄や字数超過の際に視覚的なフィードバックを出す。
  - 既存ニュース編集時には保存済みの公開状態とタイトルを初期反映させる。
  - _Requirements: R1, R3_

- [x] 2.2 ラベル選択と検証メッセージ
  - ラベル候補「重要」「システム」「一般」を選択しやすいコンポーネントで提示する。
  - 未選択のまま保存した場合は既定ラベルを自動適用し、その旨を通知する。
  - 許可外の値を入力しようとした際に警告を表示し、正しい候補へ誘導する。
  - _Requirements: R2, R3_

- [x] 3. 表示ロジックとキャッシュ整合
  - 一覧・詳細・公開カードが新しいタイトルとラベルを反映し、旧カテゴリ解析ロジックを排除する。
  - 保存後の一覧更新と公開中カードの同期を最小の再取得で実現する。
  - 失敗時のロールバックやトースト通知を新属性に合わせて調整する。
  - _Requirements: R2, R4_

- [x] 3.1 ビューモデルと表示更新
  - ビューモデルを公開状態・タイトル・ラベルの明示的な値に置き換え、派生ロジックを整理する。
  - 管理一覧、公開カード、詳細表示のタイトルとラベルを新モデルで描画する。
  - ラベルに応じたバッジスタイルを列挙値ベースで統一する。
  - _Requirements: R2, R4_

- [x] 3.2 データ同期とキャッシュ調整
  - 保存ミューテーション後に最新値をローカル状態へ反映し、一覧と公開ビューのキャッシュを順序良く更新する。
  - 公開状態が変わった場合でも部分更新で整合が取れるよう無効化戦略を見直す。
  - エラー発生時の復元処理が公開状態・タイトル・ラベルを巻き戻せるよう検証する。
  - _Requirements: R1, R4_

- [ ] 4. テストと品質確認
  - バックエンドとフロントエンドのテストを拡張し、新しい入力項目と表示ロジックを検証する。
  - 保存フローと表示更新の回帰テストを整理し、簡潔な確認手順で品質を担保する。
  - E2Eシナリオで公開切替とラベル反映が期待通り動くことを確認する。
  - _Requirements: R1, R2, R3, R4_

- [ ] 4.1 バックエンド検証
  - 保存処理とレスポンスのテストを更新し、公開状態・タイトル・ラベルの整合を確認する。
  - ラベル未指定時の既定値適用や許可外値の拒否を検証する。
  - ホーム向けデータ供給が新属性を含むことを保証する。
  - _Requirements: R1, R2, R3, R4_

- [ ] 4.2 フロントエンドとE2E検証
  - フォームUIのテストで公開トグル・タイトル・ラベルの入力制御とエラー表示を確認する。
  - 一覧と公開カードのテストで新しいタイトルとラベルが反映されることを確かめる。
  - E2Eシナリオで新規作成から公開切替までを通し、ダッシュボード表示の整合を確認する。
  - _Requirements: R1, R2, R3, R4_
