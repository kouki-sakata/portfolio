# Requirements Document

## Introduction
本仕様はホームダッシュボードに常時更新される現在時刻の表示を追加し、その時刻を打刻処理で利用することで、利用者が視認する時刻とサーバーへ送信される打刻時刻を一致させることを目的とする。

## Requirements

### Requirement 1: リアルタイム時刻の可視化
**Objective:** As an 従業員, I want ホーム画面で現在時刻を確認したい, so that 打刻前に自身の記録時刻を把握できる

#### Acceptance Criteria
1. WHEN ユーザーがホームダッシュボードに遷移したとき THEN 画面上部（ヒーローセクションまたは打刻カード冒頭）に現在のJST（日本標準時）の日付・曜日・時刻（秒精度）が表示される。
2. WHEN ホームダッシュボードが表示されている間 THEN 現在時刻の表示は少なくとも1秒間隔で自動更新される。
3. WHEN ダッシュボードデータの初期取得が遅延または失敗した場合でも THEN 現在時刻の表示は独立して初期化および更新される。

### Requirement 2: 打刻処理との時刻同期
**Objective:** As an 従業員, I want 表示されている現在時刻と打刻処理が同一基準で動作してほしい, so that 打刻結果にズレが生じない

#### Acceptance Criteria
1. WHEN 出勤/退勤ボタンを押下したとき THEN 打刻APIへ送信される`stampTime`は現在時刻表示と同じロジック（`Asia/Tokyo`固定の`formatLocalTimestamp`）から取得される。
2. WHEN 打刻ボタン押下後にAPIリクエストが開始されたとき THEN 送信に利用したタイムスタンプが変数として保持され、レスポンスが返るまで値が更新されない。
3. WHEN 打刻処理が成功したとき THEN 成功メッセージまたは打刻結果領域に送信したタイムスタンプが表示され、利用者が記録時刻を確認できる。
4. IF 打刻処理が失敗したとき THEN メッセージ領域に失敗理由とともに最新の現在時刻表示が継続され、再試行時には再取得した時刻が利用される。

### Requirement 3: 信頼性とフォールバック
**Objective:** As an 従業員, I want 現在時刻表示が破綻した場合でも打刻可否を判断できる情報がほしい, so that 不測のエラー時にも業務を継続できる

#### Acceptance Criteria
1. IF 現在時刻の初期化ロジックが例外を検知したとき THEN 代替テキスト（例: 「現在時刻を取得できません。端末時計を確認してください。」）を表示し、スタンプボタンは従来通り動作する。
2. WHEN 時計表示が復旧したとき THEN 自動的にリアルタイム表示へ戻り、利用者が手動でページをリロードする必要はない。
3. WHEN 打刻処理完了後にキャッシュ無効化が走ったとき THEN 現在時刻表示の更新ループは中断されず、再描画が継続する。
